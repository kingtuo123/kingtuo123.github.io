<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>STM32 EXTI 外部中断 | Notes</title><meta name=keywords content="stm32"><meta name=description content="Note"><meta name=author content><link rel=canonical href=https://kingtuo123.com/posts/stm32-exti/><link crossorigin=anonymous href=/assets/css/stylesheet.399f2655bfa7c532801339abc78603ad383a61110564ef4d7b29a8ef5a923702.css integrity="sha256-OZ8mVb+nxTKAEzmrx4YDrTg6YREFZO9Neymo71qSNwI=" rel="preload stylesheet" as=style><link rel=icon href=https://kingtuo123.com/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://kingtuo123.com/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://kingtuo123.com/favicon-32x32.png><link rel=apple-touch-icon href=https://kingtuo123.com/apple-touch-icon.png><link rel=mask-icon href=https://kingtuo123.com/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><meta property="og:title" content="STM32 EXTI 外部中断"><meta property="og:description" content="Note"><meta property="og:type" content="article"><meta property="og:url" content="https://kingtuo123.com/posts/stm32-exti/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-07-20T00:00:00+00:00"><meta property="article:modified_time" content="2022-07-20T00:00:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="STM32 EXTI 外部中断"><meta name=twitter:description content="Note"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://kingtuo123.com/posts/"},{"@type":"ListItem","position":2,"name":"STM32 EXTI 外部中断","item":"https://kingtuo123.com/posts/stm32-exti/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"STM32 EXTI 外部中断","name":"STM32 EXTI 外部中断","description":"Note","keywords":["stm32"],"articleBody":" 中断优先级 SCB 和 NVIC 相关寄存器属于内核，在 stm32编程手册 或 CM3权威指南中 能找到有关描述，参考手册是没有的。\nSCB_AIRCR 系统控制块（ System control block (SCB) ）\n应用程序中断和复位控制寄存器（ Application interrupt and reset control register ）\nPRIGROUP[2:0] ：中断优先级分组字段 NVIC_IPRx 嵌套的矢量中断控制器（ Nested vectored interrupt controller ） 中断优先级寄存器（ Interrupt priority registers ） NVIC_IPRx 用来配置外部中断 EXTIx 的优先级，IP[m] 宽度为 8bit，原则上每个外部中断可配置的优先级为 0~255，数值越小，优先级越高。但是绝大多数 CM3 芯片都会精简设计，以致实际上支持的优先级数减少，在 F103 中，只使用了高 4bit，IP[m] 如下所示：\nbit7bit6bit5bit4bit3bit2bit1bit0 用于表达优先级未使用，读回为 0 用于表达优先级的这 4bit，又被分组成 抢占优先级 和 子优先级。如果有多个中断同时响应，抢占优先级高的就会优先得到执行，如果抢占优先级相同，就比较子优先级。如果抢占优先级和子优先级都相同的话，就比较他们的硬件中断编号，编号越小，优先级越高。\n优先级分组 优先级的分组由内核外设 SCB 的应用程序中断及复位控制寄存器 AIRCR 的 PRIGROUP[2:0] 位决定，F103 分为了 5 组，具体如下：主优先级 = 抢占优先级\nPRIGROUP[2:0] 中断优先级值 PRI_N[7:4] 级数 二进制点 主优先级位 子优先级位 主优先级 子优先级 0b 011 0b xxxx. [7:4] None 16 None 0b 100 0b xxx.y [7:5] [4] 8 2 0b 101 0b xx.yy [7:6] [5:4] 4 4 0b 110 0b x.yyy [7] [6:4] 2 9 0b 111 0b .yyyy None [7:4] None 16 以 0b 100 为例，二进制点为 0b xxx.y，表示前 3 位 [7:5] 用来表示主优先级，取值范围 0-7，共 8 级；后 1 位 [4] 用来表示子优先级，取值范围 0-1，共 2 级。\n中断禁用/使能 中断函数 中断函数定义在 startup_stm32f10x_hd.s 中：\n; External Interrupts DCD WWDG_IRQHandler ; Window Watchdog DCD PVD_IRQHandler ; PVD through EXTI Line detect DCD TAMPER_IRQHandler ; Tamper DCD RTC_IRQHandler ; RTC DCD FLASH_IRQHandler ; Flash DCD RCC_IRQHandler ; RCC DCD EXTI0_IRQHandler ; EXTI Line 0 DCD EXTI1_IRQHandler ; EXTI Line 1 DCD EXTI2_IRQHandler ; EXTI Line 2 DCD EXTI3_IRQHandler ; EXTI Line 3 DCD EXTI4_IRQHandler ; EXTI Line 4 /* 篇幅有限，略去*/ 中断号 中断号定义在头文件 stm32f10x.h 的枚举 IRQn 中：\ntypedef enum IRQn { /* 篇幅有限，略去*/ EXTI0_IRQn = 6, /*!\u003c EXTI 0号线*/ EXTI1_IRQn = 7, /*!\u003c EXTI 1号线*/ EXTI2_IRQn = 8, /*!\u003c EXTI 2号线*/ EXTI3_IRQn = 9, /*!\u003c EXTI 3号线*/ EXTI4_IRQn = 10, /*!\u003c EXTI 4号线*/ ... EXTI9_5_IRQn = 23, /*!\u003c External 5号到9号线*/ ... EXTI15_10_IRQn = 40, /*!\u003c External 10号到15号线*/ /* 篇幅有限，略去*/ } 操作下面两个寄存器对应中断号的位，即可禁用/使能该中断。\nNVIC_ISERx 中断使能寄存器（ Interrupt set-enable registers ） SETENA[31:0]: 中断使能\n写： 0：无效果 1：使能中断 读： 0：中断禁用 1：中断使能 NVIC_ICERx 中断清除使能寄存器（ Interrupt clear-enable registers ） CLRENA[31:0]: 清除中断使能\n写： 0：无效果 1：禁用中断 读： 0：中断禁用 1：中断使能 NVIC 结构体定义 在文件 core_cm3.h 中：\ntypedef struct { __IO uint32_t ISER[8]; /*!\u003c Offset: 0x000 Interrupt Set Enable Register*/ uint32_t RESERVED0[24]; __IO uint32_t ICER[8]; /*!\u003c Offset: 0x080 Interrupt Clear Enable Register*/ uint32_t RSERVED1[24]; __IO uint32_t ISPR[8]; /*!\u003c Offset: 0x100 Interrupt Set Pending Register*/ uint32_t RESERVED2[24]; __IO uint32_t ICPR[8]; /*!\u003c Offset: 0x180 Interrupt Clear Pending Register*/ uint32_t RESERVED3[24]; __IO uint32_t IABR[8]; /*!\u003c Offset: 0x200 Interrupt Active bit Register*/ uint32_t RESERVED4[56]; __IO uint8_t IP[240]; /*!\u003c Offset: 0x300 Interrupt Priority Register (8Bit wide) */ uint32_t RESERVED5[644]; __O uint32_t STIR; /*!\u003c Offset: 0xE00 Software Trigger Interrupt Register*/ } NVIC_Type; 由上面可知，NVIC_ISERx 和 NVIC_ICERx 寄存器各有 8 个\n外部中断寄存器 AFIO_EXTICRx 复用功能 I/O 口（ alternate-function I/O ）\n外部中断配置寄存器（ External interrupt configuration register ）\nAFIO_EXTICR1，如下图：\n. . .\nAFIO_EXTICR2\nAFIO_EXTICR3\n. . .\nAFIO_EXTICR4，如下图：\nEXTIx[3:0]: 配置外部中断源 0000：PAx 0001：PBx 0010：PCx 0011：PDx 0100：PEx 0101：PFx 0110：PGx 对应关系如下图：\nEXTI_IMR 外部中断/事件控制器（ External interrupt/event controller (EXTI) ）\n中断屏蔽寄存器（ Interrupt mask register ）\nMRx: 屏蔽 EXTIx 中断 0：屏蔽 1：不屏蔽 EXTI_EMR 事件屏蔽寄存器（ Event mask register ） MRx: 屏蔽 EXTIx 事件 0：屏蔽 1：不屏蔽 EXTI_RTSR 上升沿触发选择寄存器（ Rising trigger selection register ） TRx: 配置 EXTIx 上升沿触发 0：禁用上升沿触发 1：使能上升沿触发 EXTI_FTSR 下降沿触发选择寄存器（Falling trigger selection register） TRx: 配置 EXTIx 下降沿触发 0：禁用下降沿触发 1：使能下降沿触发 EXTI_SWIER 软件中断事件寄存器（ Software interrupt event register ） SWIERx: 触发 EXTIx 中断 0：无效果 1：触发中断 该寄存器通过软件控制触发中断，如下图：\nEXTI_SWIER 寄存器连接到一个或门，该寄存器或外部输入信号有一个符合条件就能触发中断。\nEXTI_PR 挂起寄存器（ Pending register ） PRx: 挂起位（ Pending bit ） 0： 没有触发请求 1：EXTIx 发生了中断触发请求 当在外部中断线上发生了选择的边沿事件，该位被置 1。在该位中写入 1 可以清除它，也可以改变边沿检测的极性清除。\n例程 寄存器 void EXTI0_Config(void) { RCC-\u003eAPB2ENR |= (unsigned int)0x01 \u003c\u003c 2; //使能GPIOA时钟 GPIOA-\u003eCRL |= (unsigned int)0x04 \u003c\u003c 0; //PA0 配置浮空输入 RCC-\u003eAPB2ENR |= (unsigned int)0x01 \u003c\u003c 0; //使能AFIO时钟 AFIO-\u003eEXTICR[0] |= (unsigned int)0x00 \u003c\u003c 0; //连接EXTI0输入线到PA0上 SCB-\u003eAIRCR |= (unsigned int)0x05 \u003c\u003c 8; //中断控制器配置优先级分组，主2比特子2比特 NVIC-\u003eIP[0] |= (unsigned int)0xC0 \u003c\u003c 0; //配置优先级主3子0（0b 1100 0000） NVIC-\u003eISER[0] |= (unsigned int)0x01 \u003c\u003c 6; //使能EXTI0中断 EXTI-\u003eIMR |= (unsigned int)0x01 \u003c\u003c 0; //不屏蔽EXTI0中断 EXTI-\u003eRTSR |= (unsigned int)0x01 \u003c\u003c 0; //配置上升沿触发 } void EXTI0_IRQHandler(void) { if(EXTI-\u003ePR \u0026 0x01) //检查EXTI0中断挂起标志 {\tEXTI-\u003ePR = 0x01; //清除EXTI0中断挂起标志 }\t} 标准库 void EXTI0_Config(void) { /* Enable GPIOA clock */ RCC_APB2PeriphClockCmd(RCC_APB2Periph_GPIOA, ENABLE); /* Configure PA.00 pin as input floating */ GPIO_InitStructure.GPIO_Pin = GPIO_Pin_0; GPIO_InitStructure.GPIO_Mode = GPIO_Mode_IN_FLOATING; GPIO_Init(GPIOA, \u0026GPIO_InitStructure); /* Enable AFIO clock */ RCC_APB2PeriphClockCmd(RCC_APB2Periph_AFIO, ENABLE); /* Connect EXTI0 Line to PA.00 pin */ GPIO_EXTILineConfig(GPIO_PortSourceGPIOA, GPIO_PinSource0); /* Configure EXTI0 line */ EXTI_InitStructure.EXTI_Line = EXTI_Line0; EXTI_InitStructure.EXTI_Mode = EXTI_Mode_Interrupt; EXTI_InitStructure.EXTI_Trigger = EXTI_Trigger_Rising; EXTI_InitStructure.EXTI_LineCmd = ENABLE; EXTI_Init(\u0026EXTI_InitStructure); /* Enable and set EXTI0 Interrupt to the lowest priority */ NVIC_InitStructure.NVIC_IRQChannel = EXTI0_IRQn; NVIC_InitStructure.NVIC_IRQChannelPreemptionPriority = 0x0F; NVIC_InitStructure.NVIC_IRQChannelSubPriority = 0x0F; NVIC_InitStructure.NVIC_IRQChannelCmd = ENABLE; NVIC_Init(\u0026NVIC_InitStructure); } void EXTI0_IRQHandler(void) { if(EXTI_GetITStatus(EXTI_Line0) != RESET) { /* Toggle LED1 */ STM_EVAL_LEDToggle(LED1); /* Clear the EXTI line 0 pending bit */ EXTI_ClearITPendingBit(EXTI_Line0); } } ","wordCount":"717","inLanguage":"en","datePublished":"2022-07-20T00:00:00Z","dateModified":"2022-07-20T00:00:00Z","mainEntityOfPage":{"@type":"WebPage","@id":"https://kingtuo123.com/posts/stm32-exti/"},"publisher":{"@type":"Organization","name":"Notes","logo":{"@type":"ImageObject","url":"https://kingtuo123.com/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://kingtuo123.com/ accesskey=h title="Notes (Alt + H)">Notes</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://kingtuo123.com/archives title=Archive><span>Archive</span></a></li><li><a href=https://kingtuo123.com/categories/ title=Categories><span>Categories</span></a></li><li><a href=https://kingtuo123.com/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://kingtuo123.com/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>STM32 EXTI 外部中断</h1><div class=post-meta><span title='2022-07-20 00:00:00 +0000 UTC'>July 20, 2022</span></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#%e4%b8%ad%e6%96%ad%e4%bc%98%e5%85%88%e7%ba%a7 aria-label=中断优先级>中断优先级</a><ul><li><a href=#scb_aircr aria-label=SCB_AIRCR>SCB_AIRCR</a></li><li><a href=#nvic_iprx aria-label=NVIC_IPRx>NVIC_IPRx</a></li><li><a href=#%e4%bc%98%e5%85%88%e7%ba%a7%e5%88%86%e7%bb%84 aria-label=优先级分组>优先级分组</a></li></ul></li><li><a href=#%e4%b8%ad%e6%96%ad%e7%a6%81%e7%94%a8%e4%bd%bf%e8%83%bd aria-label=中断禁用/使能>中断禁用/使能</a><ul><li><a href=#%e4%b8%ad%e6%96%ad%e5%87%bd%e6%95%b0 aria-label=中断函数>中断函数</a></li><li><a href=#%e4%b8%ad%e6%96%ad%e5%8f%b7 aria-label=中断号>中断号</a></li><li><a href=#nvic_iserx aria-label=NVIC_ISERx>NVIC_ISERx</a></li><li><a href=#nvic_icerx aria-label=NVIC_ICERx>NVIC_ICERx</a></li><li><a href=#nvic-%e7%bb%93%e6%9e%84%e4%bd%93%e5%ae%9a%e4%b9%89 aria-label="NVIC 结构体定义">NVIC 结构体定义</a></li></ul></li><li><a href=#%e5%a4%96%e9%83%a8%e4%b8%ad%e6%96%ad%e5%af%84%e5%ad%98%e5%99%a8 aria-label=外部中断寄存器>外部中断寄存器</a><ul><li><a href=#afio_exticrx aria-label=AFIO_EXTICRx>AFIO_EXTICRx</a></li><li><a href=#exti_imr aria-label=EXTI_IMR>EXTI_IMR</a></li><li><a href=#exti_emr aria-label=EXTI_EMR>EXTI_EMR</a></li><li><a href=#exti_rtsr aria-label=EXTI_RTSR>EXTI_RTSR</a></li><li><a href=#exti_ftsr aria-label=EXTI_FTSR>EXTI_FTSR</a></li><li><a href=#exti_swier aria-label=EXTI_SWIER>EXTI_SWIER</a></li><li><a href=#exti_pr aria-label=EXTI_PR>EXTI_PR</a></li></ul></li><li><a href=#%e4%be%8b%e7%a8%8b aria-label=例程>例程</a><ul><li><a href=#%e5%af%84%e5%ad%98%e5%99%a8 aria-label=寄存器>寄存器</a></li><li><a href=#%e6%a0%87%e5%87%86%e5%ba%93 aria-label=标准库>标准库</a></li></ul></li></ul></div></details></div><div class=post-content><div align=center><img src=0.png style=max-height:600px></img></div><h2 id=中断优先级>中断优先级<a hidden class=anchor aria-hidden=true href=#中断优先级>#</a></h2><blockquote><p>SCB 和 NVIC 相关寄存器属于内核，在 <em>stm32编程手册</em> 或 <em>CM3权威指南中</em> 能找到有关描述，参考手册是没有的。</p></blockquote><h3 id=scb_aircr>SCB_AIRCR<a hidden class=anchor aria-hidden=true href=#scb_aircr>#</a></h3><ul><li><p>系统控制块（ System control block (SCB) ）</p></li><li><p>应用程序中断和复位控制寄存器（ Application interrupt and reset control register ）</p></li></ul><div align=center><img src=1.png style=max-height:200px></img></div><ul><li><strong>PRIGROUP[2:0]</strong> ：<a href=#%E4%BC%98%E5%85%88%E7%BA%A7%E5%88%86%E7%BB%84>中断优先级分组字段</a></li></ul><h3 id=nvic_iprx>NVIC_IPRx<a hidden class=anchor aria-hidden=true href=#nvic_iprx>#</a></h3><ul><li>嵌套的矢量中断控制器（ Nested vectored interrupt controller ）</li><li>中断优先级寄存器（ Interrupt priority registers ）</li></ul><div align=center><img src=2.png style=max-height:270px></img></div><p><code>NVIC_IPRx</code> 用来配置外部中断 <code>EXTIx</code> 的优先级，<code>IP[m]</code> 宽度为 <code>8bit</code>，原则上每个外部中断可配置的优先级为 <code>0~255</code>，数值越小，优先级越高。但是绝大多数 CM3 芯片都会精简设计，以致实际上支持的优先级数减少，在 F103 中，<strong>只使用了高 4bit</strong>，<code>IP[m] </code>如下所示：</p><div align=center><table><tr align=center style=font-weight:700><td align=center>bit7</td><td>bit6</td><td>bit5</td><td>bit4</td><td>bit3</td><td>bit2</td><td>bit1</td><td>bit0</td></tr><tr><td colspan=4 align=center>用于表达优先级</td><td colspan=4 align=center>未使用，读回为 0</td></tr></table></div><p>用于表达优先级的这 <code>4bit</code>，又被分组成 <strong>抢占优先级</strong> 和 <strong>子优先级</strong>。如果有多个中断同时响应，抢占优先级高的就会优先得到执行，如果抢占优先级相同，就比较子优先级。如果抢占优先级和子优先级都相同的话，就比较他们的硬件中断编号，<strong>编号越小，优先级越高</strong>。</p><h3 id=优先级分组>优先级分组<a hidden class=anchor aria-hidden=true href=#优先级分组>#</a></h3><p>优先级的分组由内核外设 <code>SCB</code> 的应用程序中断及复位控制寄存器 <code>AIRCR</code> 的 <code>PRIGROUP[2:0]</code> 位决定，F103 分为了 5 组，具体如下：<strong>主优先级 = 抢占优先级</strong></p><div align=center><table><tr align=center style=font-weight:700><td rowspan=2>PRIGROUP[2:0]</td><td colspan=3>中断优先级值 PRI_N[7:4]</td><td colspan=2>级数</td></tr><tr align=center style=font-weight:700><td>二进制点</td><td>主优先级位</td><td>子优先级位</td><td>主优先级</td><td>子优先级</td></tr><tr align=center><td>0b 011</td><td>0b xxxx.</td><td>[7:4]</td><td>None</td><td>16</td><td>None</td></tr><tr align=center><td>0b 100</td><td>0b xxx.y</td><td>[7:5]</td><td>[4]</td><td>8</td><td>2</td></tr><tr align=center><td>0b 101</td><td>0b xx.yy</td><td>[7:6]</td><td>[5:4]</td><td>4</td><td>4</td></tr><tr align=center><td>0b 110</td><td>0b x.yyy</td><td>[7]</td><td>[6:4]</td><td>2</td><td>9</td></tr><tr align=center><td>0b 111</td><td>0b .yyyy</td><td>None</td><td>[7:4]</td><td>None</td><td>16</td></tr></table></div><p>以 <code>0b 100</code> 为例，二进制点为 <code>0b xxx.y</code>，表示前 3 位 <code>[7:5]</code> 用来表示主优先级，取值范围 <code>0-7</code>，共 8 级；后 1 位 <code>[4]</code> 用来表示子优先级，取值范围 <code>0-1</code>，共 2 级。</p><h2 id=中断禁用使能>中断禁用/使能<a hidden class=anchor aria-hidden=true href=#中断禁用使能>#</a></h2><h3 id=中断函数>中断函数<a hidden class=anchor aria-hidden=true href=#中断函数>#</a></h3><p>中断函数定义在 <code>startup_stm32f10x_hd.s</code> 中：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-asm data-lang=asm><span class=line><span class=cl><span class=c1>; External Interrupts
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nf>DCD</span>     <span class=no>WWDG_IRQHandler</span>            <span class=c1>; Window Watchdog
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nf>DCD</span>     <span class=no>PVD_IRQHandler</span>             <span class=c1>; PVD through EXTI Line detect
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nf>DCD</span>     <span class=no>TAMPER_IRQHandler</span>          <span class=c1>; Tamper
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nf>DCD</span>     <span class=no>RTC_IRQHandler</span>             <span class=c1>; RTC
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nf>DCD</span>     <span class=no>FLASH_IRQHandler</span>           <span class=c1>; Flash
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nf>DCD</span>     <span class=no>RCC_IRQHandler</span>             <span class=c1>; RCC
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nf>DCD</span>     <span class=no>EXTI0_IRQHandler</span>           <span class=c1>; EXTI Line 0
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nf>DCD</span>     <span class=no>EXTI1_IRQHandler</span>           <span class=c1>; EXTI Line 1
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nf>DCD</span>     <span class=no>EXTI2_IRQHandler</span>           <span class=c1>; EXTI Line 2
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nf>DCD</span>     <span class=no>EXTI3_IRQHandler</span>           <span class=c1>; EXTI Line 3
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nf>DCD</span>     <span class=no>EXTI4_IRQHandler</span>           <span class=c1>; EXTI Line 4
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=cm>/* 篇幅有限，略去*/</span>
</span></span></code></pre></div><h3 id=中断号>中断号<a hidden class=anchor aria-hidden=true href=#中断号>#</a></h3><p>中断号定义在头文件 <code>stm32f10x.h</code> 的枚举 <code>IRQn</code> 中：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=k>typedef</span> <span class=k>enum</span> <span class=n>IRQn</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=cm>/* 篇幅有限，略去*/</span>
</span></span><span class=line><span class=cl>  <span class=n>EXTI0_IRQn</span>                  <span class=o>=</span> <span class=mi>6</span><span class=p>,</span>      <span class=cm>/*!&lt; EXTI 0号线*/</span>
</span></span><span class=line><span class=cl>  <span class=n>EXTI1_IRQn</span>                  <span class=o>=</span> <span class=mi>7</span><span class=p>,</span>      <span class=cm>/*!&lt; EXTI 1号线*/</span>
</span></span><span class=line><span class=cl>  <span class=n>EXTI2_IRQn</span>                  <span class=o>=</span> <span class=mi>8</span><span class=p>,</span>      <span class=cm>/*!&lt; EXTI 2号线*/</span>
</span></span><span class=line><span class=cl>  <span class=n>EXTI3_IRQn</span>                  <span class=o>=</span> <span class=mi>9</span><span class=p>,</span>      <span class=cm>/*!&lt; EXTI 3号线*/</span>
</span></span><span class=line><span class=cl>  <span class=n>EXTI4_IRQn</span>                  <span class=o>=</span> <span class=mi>10</span><span class=p>,</span>     <span class=cm>/*!&lt; EXTI 4号线*/</span>
</span></span><span class=line><span class=cl>  <span class=p>...</span>    
</span></span><span class=line><span class=cl>  <span class=n>EXTI9_5_IRQn</span>                <span class=o>=</span> <span class=mi>23</span><span class=p>,</span>     <span class=cm>/*!&lt; External 5号到9号线*/</span>
</span></span><span class=line><span class=cl>  <span class=p>...</span>
</span></span><span class=line><span class=cl>  <span class=n>EXTI15_10_IRQn</span>              <span class=o>=</span> <span class=mi>40</span><span class=p>,</span>     <span class=cm>/*!&lt; External 10号到15号线*/</span>
</span></span><span class=line><span class=cl>  <span class=cm>/* 篇幅有限，略去*/</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>操作下面两个寄存器对应中断号的位，即可禁用/使能该中断。</p><h3 id=nvic_iserx>NVIC_ISERx<a hidden class=anchor aria-hidden=true href=#nvic_iserx>#</a></h3><ul><li>中断使能寄存器（ Interrupt set-enable registers ）</li></ul><div align=center><img src=3.png style=max-height:200px></img></div><p><strong>SETENA[31:0]</strong>: 中断使能</p><ul><li>写：<ul><li>0：无效果</li><li>1：使能中断</li></ul></li><li>读：<ul><li>0：中断禁用</li><li>1：中断使能</li></ul></li></ul><h3 id=nvic_icerx>NVIC_ICERx<a hidden class=anchor aria-hidden=true href=#nvic_icerx>#</a></h3><ul><li>中断清除使能寄存器（ Interrupt clear-enable registers ）</li></ul><div align=center><img src=9.png style=max-height:200px></img></div><p><strong>CLRENA[31:0]</strong>: 清除中断使能</p><ul><li>写：<ul><li>0：无效果</li><li>1：禁用中断</li></ul></li><li>读：<ul><li>0：中断禁用</li><li>1：中断使能</li></ul></li></ul><h3 id=nvic-结构体定义>NVIC 结构体定义<a hidden class=anchor aria-hidden=true href=#nvic-结构体定义>#</a></h3><p>在文件 <code>core_cm3.h</code> 中：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=k>typedef</span> <span class=k>struct</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=n>__IO</span> <span class=kt>uint32_t</span> <span class=n>ISER</span><span class=p>[</span><span class=mi>8</span><span class=p>];</span>         <span class=cm>/*!&lt; Offset: 0x000  Interrupt Set Enable Register*/</span>
</span></span><span class=line><span class=cl>       <span class=kt>uint32_t</span> <span class=n>RESERVED0</span><span class=p>[</span><span class=mi>24</span><span class=p>];</span>                                   
</span></span><span class=line><span class=cl>  <span class=n>__IO</span> <span class=kt>uint32_t</span> <span class=n>ICER</span><span class=p>[</span><span class=mi>8</span><span class=p>];</span>         <span class=cm>/*!&lt; Offset: 0x080  Interrupt Clear Enable Register*/</span>
</span></span><span class=line><span class=cl>       <span class=kt>uint32_t</span> <span class=n>RSERVED1</span><span class=p>[</span><span class=mi>24</span><span class=p>];</span>                                    
</span></span><span class=line><span class=cl>  <span class=n>__IO</span> <span class=kt>uint32_t</span> <span class=n>ISPR</span><span class=p>[</span><span class=mi>8</span><span class=p>];</span>         <span class=cm>/*!&lt; Offset: 0x100  Interrupt Set Pending Register*/</span>
</span></span><span class=line><span class=cl>       <span class=kt>uint32_t</span> <span class=n>RESERVED2</span><span class=p>[</span><span class=mi>24</span><span class=p>];</span>                                   
</span></span><span class=line><span class=cl>  <span class=n>__IO</span> <span class=kt>uint32_t</span> <span class=n>ICPR</span><span class=p>[</span><span class=mi>8</span><span class=p>];</span>         <span class=cm>/*!&lt; Offset: 0x180  Interrupt Clear Pending Register*/</span>
</span></span><span class=line><span class=cl>       <span class=kt>uint32_t</span> <span class=n>RESERVED3</span><span class=p>[</span><span class=mi>24</span><span class=p>];</span>                                   
</span></span><span class=line><span class=cl>  <span class=n>__IO</span> <span class=kt>uint32_t</span> <span class=n>IABR</span><span class=p>[</span><span class=mi>8</span><span class=p>];</span>         <span class=cm>/*!&lt; Offset: 0x200  Interrupt Active bit Register*/</span>
</span></span><span class=line><span class=cl>       <span class=kt>uint32_t</span> <span class=n>RESERVED4</span><span class=p>[</span><span class=mi>56</span><span class=p>];</span>                                   
</span></span><span class=line><span class=cl>  <span class=n>__IO</span> <span class=kt>uint8_t</span>  <span class=n>IP</span><span class=p>[</span><span class=mi>240</span><span class=p>];</span>         <span class=cm>/*!&lt; Offset: 0x300  Interrupt Priority Register (8Bit wide) */</span>
</span></span><span class=line><span class=cl>       <span class=kt>uint32_t</span> <span class=n>RESERVED5</span><span class=p>[</span><span class=mi>644</span><span class=p>];</span>                                  
</span></span><span class=line><span class=cl>  <span class=n>__O</span>  <span class=kt>uint32_t</span> <span class=n>STIR</span><span class=p>;</span>            <span class=cm>/*!&lt; Offset: 0xE00  Software Trigger Interrupt Register*/</span>
</span></span><span class=line><span class=cl><span class=p>}</span>  <span class=n>NVIC_Type</span><span class=p>;</span>   
</span></span></code></pre></div><p>由上面可知，NVIC_ISERx 和 NVIC_ICERx 寄存器各有 8 个</p><h2 id=外部中断寄存器>外部中断寄存器<a hidden class=anchor aria-hidden=true href=#外部中断寄存器>#</a></h2><h3 id=afio_exticrx>AFIO_EXTICRx<a hidden class=anchor aria-hidden=true href=#afio_exticrx>#</a></h3><ul><li><p>复用功能 I/O 口（ alternate-function I/O ）</p></li><li><p>外部中断配置寄存器（ External interrupt configuration register ）</p></li></ul><p><strong>AFIO_EXTICR1</strong>，如下图：</p><div align=center><img src=4.png style=max-height:200px></img></div><p>. . .</p><p>AFIO_EXTICR2</p><p>AFIO_EXTICR3</p><p>. . .</p><p><strong>AFIO_EXTICR4</strong>，如下图：</p><div align=center><img src=5.png style=max-height:200px></img></div><ul><li><strong>EXTIx[3:0]:</strong> 配置外部中断源<ul><li><code>0000</code>：PAx</li><li><code>0001</code>：PBx</li><li><code>0010</code>：PCx</li><li><code>0011</code>：PDx</li><li><code>0100</code>：PEx</li><li><code>0101</code>：PFx</li><li><code>0110</code>：PGx</li></ul></li></ul><p>对应关系如下图：</p><div align=center><img src=6.png style=max-height:800px></img></div><h3 id=exti_imr>EXTI_IMR<a hidden class=anchor aria-hidden=true href=#exti_imr>#</a></h3><ul><li><p>外部中断/事件控制器（ External interrupt/event controller (EXTI) ）</p></li><li><p>中断屏蔽寄存器（ Interrupt mask register ）</p></li></ul><div align=center><img src=7.png style=max-height:200px></img></div><ul><li><strong>MRx:</strong> 屏蔽 EXTIx 中断<ul><li><code>0</code>：屏蔽</li><li><code>1</code>：不屏蔽</li></ul></li></ul><h3 id=exti_emr>EXTI_EMR<a hidden class=anchor aria-hidden=true href=#exti_emr>#</a></h3><ul><li>事件屏蔽寄存器（ Event mask register ）</li></ul><div align=center><img src=7.png style=max-height:200px></img></div><ul><li><strong>MRx:</strong> 屏蔽 EXTIx 事件<ul><li><code>0</code>：屏蔽</li><li><code>1</code>：不屏蔽</li></ul></li></ul><h3 id=exti_rtsr>EXTI_RTSR<a hidden class=anchor aria-hidden=true href=#exti_rtsr>#</a></h3><ul><li>上升沿触发选择寄存器（ Rising trigger selection register ）</li></ul><div align=center><img src=8.png style=max-height:200px></img></div><ul><li><strong>TRx:</strong> 配置 EXTIx 上升沿触发<ul><li><code>0</code>：禁用上升沿触发</li><li><code>1</code>：使能上升沿触发</li></ul></li></ul><h3 id=exti_ftsr>EXTI_FTSR<a hidden class=anchor aria-hidden=true href=#exti_ftsr>#</a></h3><ul><li>下降沿触发选择寄存器（Falling trigger selection register）</li></ul><div align=center><img src=8.png style=max-height:200px></img></div><ul><li><strong>TRx:</strong> 配置 EXTIx 下降沿触发<ul><li><code>0</code>：禁用下降沿触发</li><li><code>1</code>：使能下降沿触发</li></ul></li></ul><h3 id=exti_swier>EXTI_SWIER<a hidden class=anchor aria-hidden=true href=#exti_swier>#</a></h3><ul><li>软件中断事件寄存器（ Software interrupt event register ）</li></ul><div align=center><img src=10.png style=max-height:200px></img></div><ul><li><strong>SWIERx:</strong> 触发 EXTIx 中断<ul><li><code>0</code>：无效果</li><li><code>1</code>：触发中断</li></ul></li></ul><p>该寄存器通过软件控制触发中断，如下图：</p><div align=center><img src=11.png style=max-height:600px></img></div><p>EXTI_SWIER 寄存器连接到一个或门，该寄存器或外部输入信号有一个符合条件就能触发中断。</p><h3 id=exti_pr>EXTI_PR<a hidden class=anchor aria-hidden=true href=#exti_pr>#</a></h3><ul><li>挂起寄存器（ Pending register ）</li></ul><div align=center><img src=12.png style=max-height:200px></img></div><ul><li><strong>PRx:</strong> 挂起位（ Pending bit ）<ul><li><code>0</code>： 没有触发请求</li><li><code>1</code>：EXTIx 发生了中断触发请求</li></ul></li></ul><p>当在外部中断线上发生了选择的边沿事件，该位被置 1。在该位中写入 1 可以清除它，也可以改变边沿检测的极性清除。</p><h2 id=例程>例程<a hidden class=anchor aria-hidden=true href=#例程>#</a></h2><h3 id=寄存器>寄存器<a hidden class=anchor aria-hidden=true href=#寄存器>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=kt>void</span> <span class=nf>EXTI0_Config</span><span class=p>(</span><span class=kt>void</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=n>RCC</span><span class=o>-&gt;</span><span class=n>APB2ENR</span>    <span class=o>|=</span> <span class=p>(</span><span class=kt>unsigned</span> <span class=kt>int</span><span class=p>)</span><span class=mh>0x01</span> <span class=o>&lt;&lt;</span> <span class=mi>2</span><span class=p>;</span> <span class=c1>//使能GPIOA时钟
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=n>GPIOA</span><span class=o>-&gt;</span><span class=n>CRL</span>      <span class=o>|=</span> <span class=p>(</span><span class=kt>unsigned</span> <span class=kt>int</span><span class=p>)</span><span class=mh>0x04</span> <span class=o>&lt;&lt;</span> <span class=mi>0</span><span class=p>;</span> <span class=c1>//PA0 配置浮空输入
</span></span></span><span class=line><span class=cl><span class=c1></span>  
</span></span><span class=line><span class=cl>	<span class=n>RCC</span><span class=o>-&gt;</span><span class=n>APB2ENR</span>    <span class=o>|=</span> <span class=p>(</span><span class=kt>unsigned</span> <span class=kt>int</span><span class=p>)</span><span class=mh>0x01</span> <span class=o>&lt;&lt;</span> <span class=mi>0</span><span class=p>;</span> <span class=c1>//使能AFIO时钟
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=n>AFIO</span><span class=o>-&gt;</span><span class=n>EXTICR</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>|=</span> <span class=p>(</span><span class=kt>unsigned</span> <span class=kt>int</span><span class=p>)</span><span class=mh>0x00</span> <span class=o>&lt;&lt;</span> <span class=mi>0</span><span class=p>;</span> <span class=c1>//连接EXTI0输入线到PA0上
</span></span></span><span class=line><span class=cl><span class=c1></span>  
</span></span><span class=line><span class=cl>	<span class=n>SCB</span><span class=o>-&gt;</span><span class=n>AIRCR</span>      <span class=o>|=</span> <span class=p>(</span><span class=kt>unsigned</span> <span class=kt>int</span><span class=p>)</span><span class=mh>0x05</span> <span class=o>&lt;&lt;</span> <span class=mi>8</span><span class=p>;</span> <span class=c1>//中断控制器配置优先级分组，主2比特子2比特
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>NVIC</span><span class=o>-&gt;</span><span class=n>IP</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>     <span class=o>|=</span> <span class=p>(</span><span class=kt>unsigned</span> <span class=kt>int</span><span class=p>)</span><span class=mh>0xC0</span> <span class=o>&lt;&lt;</span> <span class=mi>0</span><span class=p>;</span> <span class=c1>//配置优先级主3子0（0b 1100 0000）
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>NVIC</span><span class=o>-&gt;</span><span class=n>ISER</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>   <span class=o>|=</span> <span class=p>(</span><span class=kt>unsigned</span> <span class=kt>int</span><span class=p>)</span><span class=mh>0x01</span> <span class=o>&lt;&lt;</span> <span class=mi>6</span><span class=p>;</span> <span class=c1>//使能EXTI0中断
</span></span></span><span class=line><span class=cl><span class=c1></span>    
</span></span><span class=line><span class=cl>	<span class=n>EXTI</span><span class=o>-&gt;</span><span class=n>IMR</span>       <span class=o>|=</span> <span class=p>(</span><span class=kt>unsigned</span> <span class=kt>int</span><span class=p>)</span><span class=mh>0x01</span> <span class=o>&lt;&lt;</span> <span class=mi>0</span><span class=p>;</span> <span class=c1>//不屏蔽EXTI0中断
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=n>EXTI</span><span class=o>-&gt;</span><span class=n>RTSR</span>      <span class=o>|=</span> <span class=p>(</span><span class=kt>unsigned</span> <span class=kt>int</span><span class=p>)</span><span class=mh>0x01</span> <span class=o>&lt;&lt;</span> <span class=mi>0</span><span class=p>;</span> <span class=c1>//配置上升沿触发
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>void</span> <span class=nf>EXTI0_IRQHandler</span><span class=p>(</span><span class=kt>void</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=k>if</span><span class=p>(</span><span class=n>EXTI</span><span class=o>-&gt;</span><span class=n>PR</span> <span class=o>&amp;</span> <span class=mh>0x01</span><span class=p>)</span> <span class=c1>//检查EXTI0中断挂起标志
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=p>{</span>				 
</span></span><span class=line><span class=cl>		<span class=n>EXTI</span><span class=o>-&gt;</span><span class=n>PR</span> <span class=o>=</span> <span class=mh>0x01</span><span class=p>;</span> <span class=c1>//清除EXTI0中断挂起标志
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=p>}</span>		 
</span></span><span class=line><span class=cl><span class=p>}</span> 
</span></span></code></pre></div><h3 id=标准库>标准库<a hidden class=anchor aria-hidden=true href=#标准库>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=kt>void</span> <span class=nf>EXTI0_Config</span><span class=p>(</span><span class=kt>void</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=cm>/* Enable GPIOA clock */</span>
</span></span><span class=line><span class=cl>  <span class=nf>RCC_APB2PeriphClockCmd</span><span class=p>(</span><span class=n>RCC_APB2Periph_GPIOA</span><span class=p>,</span> <span class=n>ENABLE</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=cm>/* Configure PA.00 pin as input floating */</span>
</span></span><span class=line><span class=cl>  <span class=n>GPIO_InitStructure</span><span class=p>.</span><span class=n>GPIO_Pin</span> <span class=o>=</span> <span class=n>GPIO_Pin_0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>GPIO_InitStructure</span><span class=p>.</span><span class=n>GPIO_Mode</span> <span class=o>=</span> <span class=n>GPIO_Mode_IN_FLOATING</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=nf>GPIO_Init</span><span class=p>(</span><span class=n>GPIOA</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>GPIO_InitStructure</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=cm>/* Enable AFIO clock */</span>
</span></span><span class=line><span class=cl>  <span class=nf>RCC_APB2PeriphClockCmd</span><span class=p>(</span><span class=n>RCC_APB2Periph_AFIO</span><span class=p>,</span> <span class=n>ENABLE</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=cm>/* Connect EXTI0 Line to PA.00 pin */</span>
</span></span><span class=line><span class=cl>  <span class=nf>GPIO_EXTILineConfig</span><span class=p>(</span><span class=n>GPIO_PortSourceGPIOA</span><span class=p>,</span> <span class=n>GPIO_PinSource0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=cm>/* Configure EXTI0 line */</span>
</span></span><span class=line><span class=cl>  <span class=n>EXTI_InitStructure</span><span class=p>.</span><span class=n>EXTI_Line</span> <span class=o>=</span> <span class=n>EXTI_Line0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>EXTI_InitStructure</span><span class=p>.</span><span class=n>EXTI_Mode</span> <span class=o>=</span> <span class=n>EXTI_Mode_Interrupt</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>EXTI_InitStructure</span><span class=p>.</span><span class=n>EXTI_Trigger</span> <span class=o>=</span> <span class=n>EXTI_Trigger_Rising</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>EXTI_InitStructure</span><span class=p>.</span><span class=n>EXTI_LineCmd</span> <span class=o>=</span> <span class=n>ENABLE</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=nf>EXTI_Init</span><span class=p>(</span><span class=o>&amp;</span><span class=n>EXTI_InitStructure</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=cm>/* Enable and set EXTI0 Interrupt to the lowest priority */</span>
</span></span><span class=line><span class=cl>  <span class=n>NVIC_InitStructure</span><span class=p>.</span><span class=n>NVIC_IRQChannel</span> <span class=o>=</span> <span class=n>EXTI0_IRQn</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>NVIC_InitStructure</span><span class=p>.</span><span class=n>NVIC_IRQChannelPreemptionPriority</span> <span class=o>=</span> <span class=mh>0x0F</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>NVIC_InitStructure</span><span class=p>.</span><span class=n>NVIC_IRQChannelSubPriority</span> <span class=o>=</span> <span class=mh>0x0F</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>NVIC_InitStructure</span><span class=p>.</span><span class=n>NVIC_IRQChannelCmd</span> <span class=o>=</span> <span class=n>ENABLE</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=nf>NVIC_Init</span><span class=p>(</span><span class=o>&amp;</span><span class=n>NVIC_InitStructure</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>void</span> <span class=nf>EXTI0_IRQHandler</span><span class=p>(</span><span class=kt>void</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span><span class=p>(</span><span class=nf>EXTI_GetITStatus</span><span class=p>(</span><span class=n>EXTI_Line0</span><span class=p>)</span> <span class=o>!=</span> <span class=n>RESET</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=cm>/* Toggle LED1 */</span>
</span></span><span class=line><span class=cl>     <span class=nf>STM_EVAL_LEDToggle</span><span class=p>(</span><span class=n>LED1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=cm>/* Clear the  EXTI line 0 pending bit */</span>
</span></span><span class=line><span class=cl>    <span class=nf>EXTI_ClearITPendingBit</span><span class=p>(</span><span class=n>EXTI_Line0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div></div><footer class=post-footer><ul class=post-tags><li><a href=https://kingtuo123.com/tags/stm32/>stm32</a></li></ul></footer></article></main><footer class=footer><span>&copy; 2023 <a href=https://kingtuo123.com/>Notes</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><div class=footer align=center style=margin-top:-30px><a href=https://beian.miit.gov.cn/ target=_blank>浙ICP备19041170号</a></div><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>