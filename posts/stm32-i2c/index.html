<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>STM32 I2C | Notes</title><meta name=keywords content="stm32"><meta name=description content="Note"><meta name=author content="kingtuo123"><link rel=canonical href=https://kingtuo123.com/posts/stm32-i2c/><link crossorigin=anonymous href=/assets/css/stylesheet.1b5446f740bb6871915d4adc115699d5a22c24bc7fa8660e3bfbb6e025fb2c4d.css integrity="sha256-G1RG90C7aHGRXUrcEVaZ1aIsJLx/qGYOO/u24CX7LE0=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://kingtuo123.com/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://kingtuo123.com/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://kingtuo123.com/favicon-32x32.png><link rel=apple-touch-icon href=https://kingtuo123.com/apple-touch-icon.png><link rel=mask-icon href=https://kingtuo123.com/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><meta property="og:title" content="STM32 I2C"><meta property="og:description" content="Note"><meta property="og:type" content="article"><meta property="og:url" content="https://kingtuo123.com/posts/stm32-i2c/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-08-24T00:00:00+00:00"><meta property="article:modified_time" content="2022-08-24T00:00:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="STM32 I2C"><meta name=twitter:description content="Note"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://kingtuo123.com/posts/"},{"@type":"ListItem","position":2,"name":"STM32 I2C","item":"https://kingtuo123.com/posts/stm32-i2c/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"STM32 I2C","name":"STM32 I2C","description":"Note","keywords":["stm32"],"articleBody":"参考文章\nI2C I2C 时钟延展 基本结构 起始和停止信号 当 SCL 是高电平时 SDA 线从高电平向低电平切换，表示通讯的起始。（下降沿触发）\n当 SCL 是高电平时 SDA 线由低电平向高电平切换，表示通讯的停止。（上升沿触发）\n数据有效性 SCL 为高电平的时候 SDA 表示的数据有效\n7 位地址 如上图所示，R/W 位指示这是读取 (1) 还是写入 (0) 操作的 。\n10 位地址 10 位的地址分为两帧发送。\n第一帧，0b 11110 表示使用 10 位的地址。A9、A8 是地址的高 2 位。 第二帧，A7-A0 是地址的后 8 位。 第三帧，普通的数据帧。 响应 响应包括 “应答 (ACK)” 和 “非应答 (NACK)” 两种信号。\nACK：继续发送 NACK：结束发送 重复起始信号 I2C 通讯更常用的是复合格式，例如：第一次通讯是告诉从机读写地址，第二次则是读写的实际内容。\n重复起始信号如下：\n时钟延展 在 I2C 的主从通信过程中，总线上的 SCL 时钟总是由主机来产生和控制的，但如果从机跟不上主机的速率，I2C 协议规定从机是可以通过将 SCL 时钟线拉低来暂停一下传输，直到从机释放掉SCL线，传输继续进行。\n总的来说，clock stretching 其实是一种降频的手段，使得更高频率的主机也能适应低频率从机的通信。\n寄存器 控制寄存器 1（I2C CR1） 控制寄存器 2（I2C_CR2） 自身地址寄存器 1（I2C_OAR1） 自身地址寄存器 2（I2C_OAR2） 数据寄存器（I2C_DR） 状态寄存器 1（I2C_SR1） 状态寄存器 2 （I2C_SR2） 时钟控制寄存器（I2C_CCR） TRISE寄存器（I2C_TRISE） 例程 标准库 static void I2C_GPIO_Config(void){ GPIO_InitTypeDef GPIO_InitStructure; /* 使能与 I2C 有关的时钟 */ EEPROM_I2C_APBxClock_FUN ( EEPROM_I2C_CLK, ENABLE ); EEPROM_I2C_GPIO_APBxClock_FUN ( EEPROM_I2C_GPIO_CLK, ENABLE ); /* I2C_SCL 外部3V3上拉，开漏输出 */ GPIO_InitStructure.GPIO_Pin = EEPROM_I2C_SCL_PIN; GPIO_InitStructure.GPIO_Speed = GPIO_Speed_50MHz; GPIO_InitStructure.GPIO_Mode = GPIO_Mode_AF_OD; GPIO_Init(EEPROM_I2C_SCL_PORT, \u0026GPIO_InitStructure); /* I2C_SDA 外部3V3上拉，开漏输出 */ GPIO_InitStructure.GPIO_Pin = EEPROM_I2C_SDA_PIN; GPIO_InitStructure.GPIO_Speed = GPIO_Speed_50MHz; GPIO_InitStructure.GPIO_Mode = GPIO_Mode_AF_OD; GPIO_Init(EEPROM_I2C_SDA_PORT, \u0026GPIO_InitStructure); } static void I2C_Mode_Configu(void){ I2C_InitTypeDef I2C_InitStructure; /* I2C 配置 */ I2C_InitStructure.I2C_Mode = I2C_Mode_I2C; /* 高电平数据稳定，低电平数据变化 SCL 时钟线的占空比 */ I2C_InitStructure.I2C_DutyCycle = I2C_DutyCycle_2; I2C_InitStructure.I2C_OwnAddress1 =I2Cx_OWN_ADDRESS7; I2C_InitStructure.I2C_Ack = I2C_Ack_Enable; /* I2C 的寻址模式 */ I2C_InitStructure.I2C_AcknowledgedAddress = I2C_AcknowledgedAddress_7bit; /* 通信速率 */ I2C_InitStructure.I2C_ClockSpeed = I2C_Speed; /* I2C 初始化 */ I2C_Init(EEPROM_I2Cx, \u0026I2C_InitStructure); /* 使能 I2C */ I2C_Cmd(EEPROM_I2Cx, ENABLE); } /** * @brief I2C 外设 (EEPROM) 初始化 * @param 无 * @retval 无 */ void I2C_EE_Init(void){ I2C_GPIO_Config(); I2C_Mode_Configu(); /* 根据头文件 i2c_ee.h 中的定义来选择 EEPROM 要写入的设备地址 */ /* 选择 EEPROM Block0 来写入 */ EEPROM_ADDRESS = EEPROM_Block0_ADDRESS; } ","wordCount":"230","inLanguage":"en","datePublished":"2022-08-24T00:00:00Z","dateModified":"2022-08-24T00:00:00Z","author":{"@type":"Person","name":"kingtuo123"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://kingtuo123.com/posts/stm32-i2c/"},"publisher":{"@type":"Organization","name":"Notes","logo":{"@type":"ImageObject","url":"https://kingtuo123.com/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://kingtuo123.com/ accesskey=h title="Notes (Alt + H)">Notes</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://kingtuo123.com/archives title=Archive><span>Archive</span></a></li><li><a href=https://kingtuo123.com/categories/ title=Categories><span>Categories</span></a></li><li><a href=https://kingtuo123.com/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://kingtuo123.com/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>STM32 I2C</h1><div class=post-meta><span title='2022-08-24 00:00:00 +0000 UTC'>August 24, 2022</span></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#%e5%9f%ba%e6%9c%ac%e7%bb%93%e6%9e%84 aria-label=基本结构>基本结构</a><ul><li><a href=#%e8%b5%b7%e5%a7%8b%e5%92%8c%e5%81%9c%e6%ad%a2%e4%bf%a1%e5%8f%b7 aria-label=起始和停止信号>起始和停止信号</a></li><li><a href=#%e6%95%b0%e6%8d%ae%e6%9c%89%e6%95%88%e6%80%a7 aria-label=数据有效性>数据有效性</a></li><li><a href=#7-%e4%bd%8d%e5%9c%b0%e5%9d%80 aria-label="7 位地址">7 位地址</a></li><li><a href=#10-%e4%bd%8d%e5%9c%b0%e5%9d%80 aria-label="10 位地址">10 位地址</a></li><li><a href=#%e5%93%8d%e5%ba%94 aria-label=响应>响应</a></li><li><a href=#%e9%87%8d%e5%a4%8d%e8%b5%b7%e5%a7%8b%e4%bf%a1%e5%8f%b7 aria-label=重复起始信号>重复起始信号</a></li><li><a href=#%e6%97%b6%e9%92%9f%e5%bb%b6%e5%b1%95 aria-label=时钟延展>时钟延展</a></li></ul></li><li><a href=#%e5%af%84%e5%ad%98%e5%99%a8 aria-label=寄存器>寄存器</a></li><li><a href=#%e4%be%8b%e7%a8%8b aria-label=例程>例程</a><ul><li><a href=#%e6%a0%87%e5%87%86%e5%ba%93 aria-label=标准库>标准库</a></li></ul></li></ul></div></details></div><div class=post-content><p>参考文章</p><ul><li><a href=https://learn.sparkfun.com/tutorials/i2c/all>I2C</a></li><li><a href=https://blog.csdn.net/u011471873/article/details/85014124>I2C 时钟延展</a></li></ul><div align=left><img src=i2c.png style=max-height:1000px></img></div><h2 id=基本结构>基本结构<a hidden class=anchor aria-hidden=true href=#基本结构>#</a></h2><div align=center><img src=1.jpg style=max-height:500px></img></div><h3 id=起始和停止信号>起始和停止信号<a hidden class=anchor aria-hidden=true href=#起始和停止信号>#</a></h3><p>当 SCL 是高电平时 SDA 线从高电平向低电平切换，表示通讯的起始。（下降沿触发）</p><p>当 SCL 是高电平时 SDA 线由低电平向高电平切换，表示通讯的停止。（上升沿触发）</p><h3 id=数据有效性>数据有效性<a hidden class=anchor aria-hidden=true href=#数据有效性>#</a></h3><p>SCL 为高电平的时候 SDA 表示的数据有效</p><h3 id=7-位地址>7 位地址<a hidden class=anchor aria-hidden=true href=#7-位地址>#</a></h3><p>如上图所示，R/W 位指示这是读取 (1) 还是写入 (0) 操作的 。</p><h3 id=10-位地址>10 位地址<a hidden class=anchor aria-hidden=true href=#10-位地址>#</a></h3><div align=center><img src=2.jpg style=max-height:500px></img></div><p>10 位的地址分为两帧发送。</p><ul><li>第一帧，<code>0b 11110</code> 表示使用 10 位的地址。A9、A8 是地址的高 2 位。</li><li>第二帧，A7-A0 是地址的后 8 位。</li><li>第三帧，普通的数据帧。</li></ul><h3 id=响应>响应<a hidden class=anchor aria-hidden=true href=#响应>#</a></h3><p>响应包括 <strong>“应答 (ACK)”</strong> 和 <strong>“非应答 (NACK)”</strong> 两种信号。</p><ul><li>ACK：继续发送</li><li>NACK：结束发送</li></ul><h3 id=重复起始信号>重复起始信号<a hidden class=anchor aria-hidden=true href=#重复起始信号>#</a></h3><p>I2C 通讯更常用的是复合格式，例如：第一次通讯是告诉从机读写地址，第二次则是读写的实际内容。</p><p>重复起始信号如下：</p><div align=left><img src=3.jpg style=max-height:400px></img></div><h3 id=时钟延展>时钟延展<a hidden class=anchor aria-hidden=true href=#时钟延展>#</a></h3><p>在 I2C 的主从通信过程中，总线上的 SCL 时钟总是由主机来产生和控制的，但如果从机跟不上主机的速率，I2C 协议规定从机是可以通过将 SCL 时钟线拉低来暂停一下传输，直到从机释放掉SCL线，传输继续进行。</p><div align=left><img src=4.jpg style=max-height:400px></img></div><p>总的来说，clock stretching 其实是一种降频的手段，使得更高频率的主机也能适应低频率从机的通信。</p><h2 id=寄存器>寄存器<a hidden class=anchor aria-hidden=true href=#寄存器>#</a></h2><ul><li>控制寄存器 1（I2C CR1）</li><li>控制寄存器 2（I2C_CR2）</li><li>自身地址寄存器 1（I2C_OAR1）</li><li>自身地址寄存器 2（I2C_OAR2）</li><li>数据寄存器（I2C_DR）</li><li>状态寄存器 1（I2C_SR1）</li><li>状态寄存器 2 （I2C_SR2）</li><li>时钟控制寄存器（I2C_CCR）</li><li>TRISE寄存器（I2C_TRISE）</li></ul><div align=center><img src=1.png style=max-height:1000px></img></div><h2 id=例程>例程<a hidden class=anchor aria-hidden=true href=#例程>#</a></h2><h3 id=标准库>标准库<a hidden class=anchor aria-hidden=true href=#标准库>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=k>static</span> <span class=kt>void</span> <span class=nf>I2C_GPIO_Config</span><span class=p>(</span><span class=kt>void</span><span class=p>){</span>
</span></span><span class=line><span class=cl>    <span class=n>GPIO_InitTypeDef</span> <span class=n>GPIO_InitStructure</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=cm>/* 使能与 I2C 有关的时钟 */</span>
</span></span><span class=line><span class=cl>    <span class=nf>EEPROM_I2C_APBxClock_FUN</span> <span class=p>(</span> <span class=n>EEPROM_I2C_CLK</span><span class=p>,</span> <span class=n>ENABLE</span> <span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nf>EEPROM_I2C_GPIO_APBxClock_FUN</span> <span class=p>(</span> <span class=n>EEPROM_I2C_GPIO_CLK</span><span class=p>,</span> <span class=n>ENABLE</span> <span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=cm>/* I2C_SCL 外部3V3上拉，开漏输出 */</span>
</span></span><span class=line><span class=cl>    <span class=n>GPIO_InitStructure</span><span class=p>.</span><span class=n>GPIO_Pin</span>   <span class=o>=</span> <span class=n>EEPROM_I2C_SCL_PIN</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>GPIO_InitStructure</span><span class=p>.</span><span class=n>GPIO_Speed</span> <span class=o>=</span> <span class=n>GPIO_Speed_50MHz</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>GPIO_InitStructure</span><span class=p>.</span><span class=n>GPIO_Mode</span>  <span class=o>=</span> <span class=n>GPIO_Mode_AF_OD</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=nf>GPIO_Init</span><span class=p>(</span><span class=n>EEPROM_I2C_SCL_PORT</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>GPIO_InitStructure</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=cm>/* I2C_SDA 外部3V3上拉，开漏输出 */</span>
</span></span><span class=line><span class=cl>    <span class=n>GPIO_InitStructure</span><span class=p>.</span><span class=n>GPIO_Pin</span>   <span class=o>=</span> <span class=n>EEPROM_I2C_SDA_PIN</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>GPIO_InitStructure</span><span class=p>.</span><span class=n>GPIO_Speed</span> <span class=o>=</span> <span class=n>GPIO_Speed_50MHz</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>GPIO_InitStructure</span><span class=p>.</span><span class=n>GPIO_Mode</span>  <span class=o>=</span> <span class=n>GPIO_Mode_AF_OD</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=nf>GPIO_Init</span><span class=p>(</span><span class=n>EEPROM_I2C_SDA_PORT</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>GPIO_InitStructure</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>static</span> <span class=kt>void</span> <span class=nf>I2C_Mode_Configu</span><span class=p>(</span><span class=kt>void</span><span class=p>){</span>
</span></span><span class=line><span class=cl>    <span class=n>I2C_InitTypeDef</span> <span class=n>I2C_InitStructure</span><span class=p>;</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl>    <span class=cm>/* I2C 配置 */</span>
</span></span><span class=line><span class=cl>    <span class=n>I2C_InitStructure</span><span class=p>.</span><span class=n>I2C_Mode</span> <span class=o>=</span> <span class=n>I2C_Mode_I2C</span><span class=p>;</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl>    <span class=cm>/* 高电平数据稳定，低电平数据变化 SCL 时钟线的占空比 */</span>
</span></span><span class=line><span class=cl>    <span class=n>I2C_InitStructure</span><span class=p>.</span><span class=n>I2C_DutyCycle</span> <span class=o>=</span> <span class=n>I2C_DutyCycle_2</span><span class=p>;</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl>    <span class=n>I2C_InitStructure</span><span class=p>.</span><span class=n>I2C_OwnAddress1</span> <span class=o>=</span><span class=n>I2Cx_OWN_ADDRESS7</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>I2C_InitStructure</span><span class=p>.</span><span class=n>I2C_Ack</span> <span class=o>=</span> <span class=n>I2C_Ack_Enable</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>    <span class=cm>/* I2C 的寻址模式 */</span>
</span></span><span class=line><span class=cl>    <span class=n>I2C_InitStructure</span><span class=p>.</span><span class=n>I2C_AcknowledgedAddress</span> <span class=o>=</span> <span class=n>I2C_AcknowledgedAddress_7bit</span><span class=p>;</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl>    <span class=cm>/* 通信速率 */</span>
</span></span><span class=line><span class=cl>    <span class=n>I2C_InitStructure</span><span class=p>.</span><span class=n>I2C_ClockSpeed</span> <span class=o>=</span> <span class=n>I2C_Speed</span><span class=p>;</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl>    <span class=cm>/* I2C 初始化 */</span>
</span></span><span class=line><span class=cl>    <span class=nf>I2C_Init</span><span class=p>(</span><span class=n>EEPROM_I2Cx</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>I2C_InitStructure</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=cm>/* 使能 I2C */</span>
</span></span><span class=line><span class=cl>    <span class=nf>I2C_Cmd</span><span class=p>(</span><span class=n>EEPROM_I2Cx</span><span class=p>,</span> <span class=n>ENABLE</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=cm>/**
</span></span></span><span class=line><span class=cl><span class=cm>* @brief I2C 外设 (EEPROM) 初始化
</span></span></span><span class=line><span class=cl><span class=cm>* @param 无
</span></span></span><span class=line><span class=cl><span class=cm>* @retval 无
</span></span></span><span class=line><span class=cl><span class=cm>*/</span>
</span></span><span class=line><span class=cl><span class=kt>void</span> <span class=nf>I2C_EE_Init</span><span class=p>(</span><span class=kt>void</span><span class=p>){</span>
</span></span><span class=line><span class=cl>    <span class=nf>I2C_GPIO_Config</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=nf>I2C_Mode_Configu</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=cm>/* 根据头文件 i2c_ee.h 中的定义来选择 EEPROM 要写入的设备地址 */</span>
</span></span><span class=line><span class=cl>    <span class=cm>/* 选择 EEPROM Block0 来写入 */</span>
</span></span><span class=line><span class=cl>    <span class=n>EEPROM_ADDRESS</span> <span class=o>=</span> <span class=n>EEPROM_Block0_ADDRESS</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div></div><footer class=post-footer><ul class=post-tags><li><a href=https://kingtuo123.com/tags/stm32/>stm32</a></li></ul></footer></article></main><footer class=footer><span>&copy; 2023 <a href=https://kingtuo123.com/>Notes</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><div class=footer align=center style=margin-top:-30px><a href=https://beian.miit.gov.cn/ target=_blank>浙ICP备19041170号-1</a></div><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>